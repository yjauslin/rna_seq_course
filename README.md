# RNA-Seq Course

This repository contains code files produced during the RNA-Seq course of the University of Bern.

### Description of Files:
- **[01_run_fastqc](01_run_fastqc)**: Produces FastQC files of all the reads, which are used to check the quality of the reads.
  
- **[02_run_fastp](02_run_fastp)**: Cleans up reads using fastp for the given read number.

- **[03_run_fastqc_cleaned](03_run_fastqc_cleaned)**: Analyses the cleaned outputs gained through fastp and summarizes the resulting statistics in a multiqc-output
  
- **[04_get_assmbly_annt](04_get_assmbly_annt)**: Downloads the reference genome as well as the annotation file used for this project from Ensembl.
  
- **[05_run_hisat2_indexing](05_run_hisat2_indexing)**: Produces index files for the reference genome using HISAT2.
  
- **[06_run_hisat2_mapping](06_run_hisat2_mapping)**: Maps the reads to the reference genome using HISAT2 and produces .sam files as a result.
   
- **[07_convert_sam_to_bam](07_convert_sam_to_bam)**: Converts the resulting .sam files from 06a_run_hisat2_mapping into .bam files.
  
- **[08_run_samtools_sort](08_run_samtools_sort)**: Sorts the BAM files using samtools.
  
- **[09_run_samtools_index](09_run_samtools_index)**: Produces index files for all the produced .bam files.
  
- **[10_run_featureCounts](10_run_featureCounts)**: Runs the sorted BAM files through featureCounts to analyze differential gene expression.
  
- **[11_run_multiqc](11_run_multiqc)**: Submits the whole project folder to analysis by multiqc. Useful to summarize statistics produced by featureCounts and hisat2 during mapping of the reads

- **[DESeq_analysis.R](DESeq_analysis.R)**: Analyzes the edited_counts.txt object generated by 10_run_featureCounts for differentialy expressed genes and overrepresented genes. The file creates the plots contained in the report.

- **[multiqc_plots.R](multiqc_plots.R)**: Generates plots based on summary statistics from data extracted from MultiQC (Step 11).
- **[fastqc_per_base_sequence_quality_plot.csv](fastqc_per_base_sequence_quality_plot.csv)**: FastQC per base sequence quality data for cleaned and raw reads.
- **[bowtie2_pe_plot.csv](bowtie2_pe_plot.csv)**: Mapping alignment data from HISAT2 (Step 6)
- **[featureCounts_assignment_plot.csv](featureCounts_assignment_plot.csv)**: FeatureCounts alignment data generated at step 10 

### How to execute analysis...
Execute the files in order of their number from small to large. Step 11 can be skipped as it is not mandatory for the proceeding analysis and acts as a collection of statistics of previous steps. Make sure to implement --mail-user to receive emails regarding the status of the jobs and change --output parameter to fit your preferred location. R-Script DESeq_analysis.R should be executed after 10_runfeatureCounts as it needs the counts_filtered.txt object produced from that file. Before running R-script multiqc_plots.R make sure that you have downloaded all .csv files in this repository and have them in the same folder as the script. Instead of looking at the plots generated by this R-script you can also just look at the output file of 11_run_multiqc.
Before executing the R-Script make sure that the following R-packages have been installed:
- **[ggplot2](https://ggplot2.tidyverse.org)**: install.packages("ggplot2")
-  **[DESeq2](https://bioconductor.org/packages/release/bioc/html/DESeq2.html)**: if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager"); BiocManager::install("DESeq2")
-  **[clusterProfiler](https://bioconductor.org/packages/release/bioc/html/clusterProfiler.html)**: if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager"); BiocManager::install("clusterProfiler")
-  **[org.Mm.eg.db](https://bioconductor.org/packages/release/data/annotation/html/org.Mm.eg.db.html)**: if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager"); BiocManager::install("org.Mm.eg.db")
-  **[enrichplot](https://bioconductor.org/packages/release/bioc/html/enrichplot.html)**: if (!require("BiocManager", quietly = TRUE)) install.packages("BiocManager"); BiocManager::install("enrichplot")
-  **[stringr](https://stringr.tidyverse.org)**: install.packages("stringr")
-  **[forcats](https://forcats.tidyverse.org)**: install.packages("forcats")
-  **[gridExtra](https://CRAN.R-project.org/package=gridExtra)**: install.packages("gridExtra")

### Contact

For any questions, please contact: yannick.jauslin@students.unibe.ch

